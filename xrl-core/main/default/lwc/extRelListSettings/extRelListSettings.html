<template>
	<section if:true={config.dialog} role="alertdialog" tabindex="0" class="slds-modal slds-fade-in-open slds-modal_prompt slds-modal_small" aria-modal="true">
		<div class="slds-modal__container slds-scrollable_y" style={dialogCss}>
			<header class={config.dialog.css}>
				<button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title={config._LABELS.title_close} style="display:block" data-id="dialog:close" onclick={config.dialog.handleEvent}>
					<svg class="slds-button__icon slds-button__icon_large" aria-hidden="true">
						<use xlink:href="/_slds/icons/utility-sprite/svg/symbols.svg#close"></use>
					</svg>
					<span class="slds-assistive-text">{config._LABELS.title_close}</span>
				</button>
				<h2 class="slds-text-heading_medium">
					{config.dialog.title}
				</h2>
			</header>
			<div if:false={config.dialog.saveAs} class="slds-modal__content slds-p-around_medium" style="min-height300px !important;">

				<!-- Admin Part -->
				<lightning-tabset if:true={config.userInfo.isAdminAccess}>
					<!-- Field Selection Starts -->
					<lightning-tab label={config._LABELS.lbl_fieldSelection}>
						<!-- <lightning-dual-listbox data-id="dialog:setFields" label={config._LABELS.lbl_selectFields} source-label={config._LABELS.srcLbl_available} selected-label={config._LABELS.lbl_selected} field-level-help={config._LABELS.hlpTxt_selectYourPreferredFields} options={config.dialog.options} value={config.dialog.selectedFields} required-options={config.dialog.requiredOptions} onchange={config.dialog.handleEvent} size="10"></lightning-dual-listbox> -->
						<!-- <lightning-input type="text" label={config._LABELS.lbl_additionalConditionForWhereClause} field-level-help={config._LABELS.hlpTxt_additionalConditionText} value={config.dialog.listViewConfig.addCondition} data-id="dialog:setAddCondition" onchange={config.dialog.handleEvent} style="margin-top: 10px;"></lightning-input> -->
						<c-sql-Builder cfg={cfg}></c-sql-Builder>
					</lightning-tab>
					<!-- Field Selection Ends -->
					<!-- Field Settings Starts -->
					<lightning-tab label={config._LABELS.lbl_fieldSettings} title={config._LABELS.title_youCanDefineAllParametersForFields}>
						<p style="min-height:200px">
							<lightning-combobox name="status" label={config._LABELS.lbl_fieldSelection} placeholder={config._LABELS.lbl_chooseField} value={config.dialog.selectedFields} data-id="dialog:setField" onchange={config.dialog.handleEvent} options={selectedFields}>
							</lightning-combobox>

							<template if:true={config.dialog.field} for:each={colModelItem} for:item="param" for:index="index">
								<lightning-input if:false={param.isTextArea} field-level-help={param.tooltip} key={param.paramName} type={param.type} label={param.label} disabled={param.isDisabled} value={param.value} data-id="dialog:setFieldParam" data-param={param.paramName} data-type={param.type} checked={param.isChecked} onchange={config.dialog.handleEvent}></lightning-input>
								<lightning-textarea if:true={param.isTextArea} field-level-help={param.tooltip} key={param.paramName} data-type={param.type} label={param.label} value={param.value} data-id="dialog:setFieldParam" data-param={param.paramName} onchange={config.dialog.handleEvent} placeholder={param.placeHolder}></lightning-textarea>
								<lightning-button-icon if:true={param.useExample} key={param.paramName} icon-name="utility:copy_to_clipboard" class="slds-m-around_small" title="Use example" data-id="dialog:setFieldParam" data-val={param.placeHolder} data-param={param.paramName} data-type={param.type} onclick={addNewUseExampleParam}></lightning-button-icon>
							</template>		
						</p>
					</lightning-tab>
					<!-- Field Settings Ends -->
					<!-- Table Settings Starts -->
					<lightning-tab label={config._LABELS.lbl_tableSettings} title={config._LABELS.title_youCanDefineAllGeneralTableParameters}>
						<template for:each={tableItem} for:item="param" for:index="index">
							<template if:false={param.isComboBox}>
								<lightning-input if:false={param.isTextArea} field-level-help={param.tooltip} key={param.paramName} type={param.type} label={param.label} disabled={param.isDisabled} value={param.value} data-id={param.cmd} data-param={param.paramName} data-type={param.type} checked={param.isChecked} onchange={config.dialog.handleEvent}></lightning-input>
								<lightning-textarea if:true={param.isTextArea} field-level-help={param.tooltip} key={param.paramName} data-type={param.type} label={param.label} value={param.value} data-id={param.cmd} data-param={param.paramName} onchange={config.dialog.handleEvent} placeholder={param.placeHolder}></lightning-textarea>
							</template>
							<template if:true={param.isComboBox}>
								<lightning-combobox key={param.paramName} field-level-help={param.tooltip} label={param.label} placeholder={param.placeHolder} disabled={param.isDisabled} value={param.value} data-id={param.cmd} onchange={config.dialog.handleEvent} data-param={param.paramName} options={param.options}>
								</lightning-combobox>
							</template>
						</template>
					</lightning-tab>	
					<!-- Table Settings Ends -->
					<!-- Locked Fields Starts  -->
					<lightning-tab label={config._LABELS.lbl_lockedFields}>
						<lightning-dual-listbox data-id="dialog:setLockedFields" label={config._LABELS.lbl_selectLockedFields} source-label={config._LABELS.srcLbl_optional} selected-label={config._LABELS.lbl_lockedFields} field-level-help={config._LABELS.hlpTxt_selectYourLockedFields} options={config.dialog.lockedOptions} value={config.dialog.lockedFields} onchange={config.dialog.handleEvent} size="10"></lightning-dual-listbox>
					</lightning-tab>
					<!-- Locked Fields Ends  -->
					<!-- Action Starts  -->
					<lightning-tab label="Actions">
						<template if:false={config.openNewAction}>
							<lightning-button if:false={config.dialog.action} variant="brand" label="New Action" title="New Action" class="slds-m-right_x-small" onclick={handleNewAction}></lightning-button>
							<lightning-combobox name="status" label="Select Action" placeholder="Choose Action" value={config.dialog.allActions} data-id="dialog:setAction" onchange={config.dialog.handleEvent} options={config.dialog.allActions}>
							</lightning-combobox>
						</template>
						<template if:true={config.openNewAction}>
							<lightning-input id="newActionId" type="text" label="Unique Action Id" onfocusout={handleNewActionSave}></lightning-input>
							<lightning-button variant="brand" label="Save" title="Save" class="slds-m-right_x-small" onclick={handleNewActionSave}></lightning-button>
						</template>
						<template if:true={config.dialog.action} for:each={actionItem} for:item="param" for:index="index">
							<lightning-input if:false={param.isTextArea} field-level-help={param.tooltip} key={param.paramName} type={param.type} label={param.label} disabled={param.isDisabled} value={param.value} data-id="dialog:setActionParam" data-param={param.paramName} data-type={param.type} checked={param.isChecked} onchange={config.dialog.handleEvent}></lightning-input>
							<lightning-textarea if:true={param.isTextArea} field-level-help={param.tooltip} key={param.paramName} data-type={param.type} label={param.label} value={param.value} data-id="dialog:setActionParam" data-param={param.paramName} onchange={config.dialog.handleEvent} placeholder={param.placeHolder}></lightning-textarea>
						</template>
					</lightning-tab>
					<!-- Action Ends  -->
				</lightning-tabset>
				<!-- Admin Part Ends  -->
				<!-- User Part  -->
				<lightning-dual-listbox if:false={config.userInfo.isAdminAccess} data-id="dialog:setFields" label={config._LABELS.lbl_selectFields} source-label={config._LABELS.srcLbl_available} selected-label={config._LABELS.lbl_selected} field-level-help={config._LABELS.hlpTxt_selectYourPreferredFields} options={config.dialog.options} value={config.dialog.selectedFields} required-options={config.dialog.requiredOptions} onchange={config.dialog.handleEvent} size="12"></lightning-dual-listbox>
			</div>
			<footer class="slds-modal__footer modal-footer">
				<!-- Save As dialog Starts -->
				<div if:true={config.dialog.saveAs} class="slds-p-around_medium lgc-bg">
					<lightning-input type="text" label={config._LABELS.lbl_enterListViewName} placeholder={config._LABELS.lbl_typeHere} required focus data-id="dialog:saveAsName" onchange={config.dialog.handleEvent}></lightning-input>
					<lightning-input type="text" label={config._LABELS.lbl_enterListViewLabel} placeholder={config._LABELS.lbl_typeHere} required focus data-id="dialog:saveAsLabel" onchange={config.dialog.handleEvent}></lightning-input>
				</div>

				<lightning-button if:true={config.dialog.saveAs} variant="brand" label={config._LABELS.lbl_save} title={config._LABELS.lbl_save} icon-name="utility:save" class="slds-m-left_x-small" data-id="dialog:saveAsFinish" onclick={config.dialog.handleEvent}></lightning-button>
				<lightning-helptext if:true={config.dialog.saveAs} content={config._LABELS.tooltip_configSaveAsSave}></lightning-helptext>
				<lightning-button if:true={config.dialog.saveAs} variant="base" label={config._LABELS.lbl_cancel} title={config._LABELS.lbl_cancel} icon-name="utility:error" class="slds-m-left_x-small" data-id="dialog:saveAsCancel" onclick={config.dialog.handleEvent}></lightning-button>
				<lightning-helptext if:true={config.dialog.saveAs} content={config._LABELS.tooltip_configSaveAsCancel}></lightning-helptext>
				<!-- Save As dialog Ends -->

				<!-- Save Button -->
				<lightning-button if:false={config.dialog.saveAs} variant="neutral" label={config._LABELS.lbl_save} title={config._LABELS.title_saveSelectedFields} icon-name="utility:save" class="slds-m-left_x-small" data-id="dialog:save" onclick={config.dialog.handleEvent}></lightning-button>
				<lightning-helptext if:false={config.dialog.saveAs} content={config._LABELS.tooltip_configSave}></lightning-helptext>
				<!-- Save As Button -->
				<lightning-button if:false={config.dialog.saveAs} variant="brand" label={config._LABELS.lbl_saveAs} title={config._LABELS.title_saveSelectedFields} icon-name="utility:save" class="slds-m-left_x-small" data-id="dialog:saveAs" onclick={config.dialog.handleEvent}></lightning-button>
				<lightning-helptext if:false={config.dialog.saveAs} content={config._LABELS.tooltip_configSaveAs}></lightning-helptext>
				<!-- Cancel Button -->
				<lightning-button if:false={config.dialog.saveAs} variant="base" label={config._LABELS.lbl_cancel} title={config._LABELS.lbl_cancel} icon-name="utility:error" class="slds-m-left_x-small" data-id="dialog:close" onclick={config.dialog.handleEvent}></lightning-button>
				<lightning-helptext if:false={config.dialog.saveAs} content={config._LABELS.tooltip_configCancel}></lightning-helptext>
				<!-- Share Button -->
				<lightning-button if:false={config.dialog.saveAs} variant="base" label="Share" title={config._LABELS.lbl_cancel} icon-name="utility:internal_share" class="slds-m-left_x-small" data-id="dialog:config_share" onclick={config.dialog.handleEvent}></lightning-button>
				<lightning-helptext if:false={config.dialog.saveAs} content={config._LABELS.tooltip_configShare}></lightning-helptext>
				
				<template if:true={config.buttons} for:each={config.buttons} for:item="btn" for:index="index">
					<lightning-button key={btn.label} variant={btn.variant} label={btn.label} data-id={btn.dataId} icon-name={btn.iconName} onclick={config.callback} class="slds-m-around_small"></lightning-button>
				</template>
			</footer>
		</div>
	</section>
	<div class="slds-backdrop slds-backdrop_open"></div>
</template>